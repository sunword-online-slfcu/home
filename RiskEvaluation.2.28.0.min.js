/*! For license information please see RiskEvaluation.2.28.0.min.js.LICENSE.txt */
/* Minified on 4/30/2025*/
!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCMICookie=t.showMessage=t.showErrorMessage=t.initMFAModal=t.showResponseError=t.requireStepUp=t.post=t.MFAService=t.MFAComponent=void 0;const i=n(2),o=n(3),a=n(4),s=i.__importStar(n(1));t.MFAService=s;var r=n(4);Object.defineProperty(t,"MFAComponent",{enumerable:!0,get:function(){return r.MFAComponent}});const c={url:"",method:"POST",mfaAction:async e=>{const{verificationToken:t,transactionId:n,showBannerForError:i}=e;return u({escalationKey:t,transactionId:n,showBannerForError:i})},showBannerForError:!0,showBannerForValidationError:!0};function l(e){return!0===e.success&&!1===e.skip}async function d(e){const t=e instanceof Response?await e.json():e;return h(Alkami.Localization.SiteText[t.errorSiteTextKey]||t.errorMessage||Alkami.Localization.SiteText.get("ShortGeneralErrorMessage"))}async function u(e={}){var t;function n(){d.freeze=!1,d.open=!1}const{escalationKey:i,transactionId:o}=e,s=[{text:Alkami.Localization.SiteText["SecondFactorAuthentication.CancelButtonText"],type:"secondary",handlerName:"cancel",closePrompt:!1},{cls:"mfa-action-button",text:Alkami.Localization.SiteText["SecondFactorAuthentication.Challenge.VerifyButtonText"],handlerName:"verify",closePrompt:!1}],r={cancel:()=>{h.cancel(),n()}},c=Alkami.Dom.parseHTML('<div class="mfa-modal-content iris-content">\n</div>'),l=Alkami.Localization.SiteText["SecondFactorAuthentication.Header"],d=Alkami.Helpers.createDialog(Object.assign({id:"mfa_modal",title:l,buttons:s,content:c,destroyOnClose:!0,handlers:r},e));d.freeze=!0,d.element.classList.add("mfa-modal"),d.element.setAttribute("role","dialog"),d.element.setAttribute("aria-modal","true");const u=d.element.querySelector(".mfa-action-button"),h=await a.MFAComponent.init({submitButtonElement:u,escalationKey:i,transactionId:o,postVerificationAction:e.postVerificationAction,showBannerForError:e.showBannerForError});return c.appendChild(h.element),null===(t=d.element.querySelector(".iris-prompt__header"))||void 0===t||t.setAttribute("tabIndex","0"),h.element.addEventListener("mfasuccess",(()=>n())),d.open=!0,h.promise}function h(e){const t=window;e=e||t.Alkami.Localization.SiteText["Generic Error Msg"],t.Alkami.FlashBanner?t.Alkami.FlashBanner.showError(e):t.mobileUtil?t.mobileUtil.showFlashMessage("Error",e):t.showFlashError(e)}function p(){if(document.cookie.indexOf("c_m_i")>=0)return;const e={b_t_z:(new Date).getTimezoneOffset(),s_w:screen.height,s_h:screen.width};document.cookie="c_m_i="+JSON.stringify(e)}t.post=async function e(t){t=Object.assign({},c,t),p();const n=t.mfaAction;let i=t;if(!("string"==typeof t.data||t.data instanceof URLSearchParams||t.data instanceof FormData)&&t.data&&!t.data.hasOwnProperty("__RequestVerificationToken")){const e=document.querySelector('input[name="__RequestVerificationToken"]');let n;e&&(n=e.value);const o=Object.assign({__RequestVerificationToken:n},t.data);i=Object.assign({},t,{data:o})}const a=await o.ajax(i),s=await a.clone().json(),r=void 0!==s.errorMessage||void 0!==s.errorSiteTextKey;if(s.Location)window.location.href=s.Location;else{if(!1===s.success&&r)throw t.showBannerForError&&d(s),a.clone();if(l(s))return await n(s),e(t)}return a.clone()},t.requireStepUp=l,t.showResponseError=d,t.initMFAModal=u,t.showErrorMessage=h,t.showMessage=function(e){const t=window;t.Alkami.FlashBanner?t.Alkami.FlashBanner.showSuccess(e):t.mobileUtil?t.mobileUtil.showFlashMessage("Success",e):t.showFlashSuccess(e)},t.createCMICookie=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateAnswers=t.requestVerficationCode=t.fetchMFAModel=void 0;const i=n(3);t.fetchMFAModel=async function(e){const t=await i.ajax({url:"/Modules/RiskEvaluation/MFA/Initialize",method:"POST",contentType:"application/json",responseType:"json",data:{ActionType:e}});let n=await t.json();if(n.model){const e=JSON.parse(n.model);n=Object.assign(n,e)}return n},t.requestVerficationCode=async function(e){return i.ajax({url:"/Modules/RiskEvaluation/MFA/RequestCode",method:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",responseType:"json",data:e})},t.validateAnswers=async function(e){return i.ajax({url:"/Modules/RiskEvaluation/MFA/Validate",method:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",responseType:"json",data:e})}},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return o})),n.d(t,"__assign",(function(){return a})),n.d(t,"__rest",(function(){return s})),n.d(t,"__decorate",(function(){return r})),n.d(t,"__param",(function(){return c})),n.d(t,"__metadata",(function(){return l})),n.d(t,"__awaiter",(function(){return d})),n.d(t,"__generator",(function(){return u})),n.d(t,"__createBinding",(function(){return h})),n.d(t,"__exportStar",(function(){return p})),n.d(t,"__values",(function(){return m})),n.d(t,"__read",(function(){return f})),n.d(t,"__spread",(function(){return y})),n.d(t,"__spreadArrays",(function(){return _})),n.d(t,"__await",(function(){return v})),n.d(t,"__asyncGenerator",(function(){return b})),n.d(t,"__asyncDelegator",(function(){return g})),n.d(t,"__asyncValues",(function(){return S})),n.d(t,"__makeTemplateObject",(function(){return T})),n.d(t,"__importStar",(function(){return A})),n.d(t,"__importDefault",(function(){return x})),n.d(t,"__classPrivateFieldGet",(function(){return w})),n.d(t,"__classPrivateFieldSet",(function(){return C}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function s(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function r(e,t,n,i){var o,a=arguments.length,s=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s}function c(e,t){return function(n,i){t(n,i,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{c(i.next(e))}catch(e){a(e)}}function r(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}c((i=i.apply(e,t||[])).next())}))}function u(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}}function h(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}function p(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,a=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return s}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var a=arguments[t],s=0,r=a.length;s<r;s++,o++)i[o]=a[s];return i}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function b(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=n.apply(e,t||[]),a=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){o[e]&&(i[e]=function(t){return new Promise((function(n,i){a.push([e,t,n,i])>1||r(e,t)}))})}function r(e,t){try{(n=o[e](t)).value instanceof v?Promise.resolve(n.value.v).then(c,l):d(a[0][2],n)}catch(e){d(a[0][3],e)}var n}function c(e){r("next",e)}function l(e){r("throw",e)}function d(e,t){e(t),a.shift(),a.length&&r(a[0][0],a[0][1])}}function g(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,o){t[i]=e[i]?function(t){return(n=!n)?{value:v(e[i](t)),done:"return"===i}:o?o(t):t}:o}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=m(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,o){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,o,(t=e[n](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function C(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ajax=void 0;const i={url:"",method:"GET"};t.ajax=async function(e){e=Object.assign({},i,e);let t=null,n=e.url;if(e.data)if("GET"===e.method){const t=n.split("?"),i=new URLSearchParams(t[1]||"");Object.keys(e.data).forEach((t=>{i.append(t,e.data[t])})),n=t[0]+"?"+i.toString()}else if(e.contentType)if(0===e.contentType.indexOf("multipart/form-data"))t=new FormData,Object.keys(e.data).forEach((n=>{t.append(n,e.data[n])}));else if(0===e.contentType.indexOf("application/x-www-form-urlencoded")){const n=new URLSearchParams,i=e.data;Object.keys(i).forEach((e=>{[].concat(i[e]).forEach((t=>{n.append(e,t)}))})),t=n.toString()}else t=0===e.contentType.indexOf("application/json")?JSON.stringify(e.data):e.data.toString();else"string"==typeof e.data?t=e.data:e.data instanceof URLSearchParams?(e.contentType="application/x-www-form-urlencoded; charset=UTF-8",t=e.data):e.data instanceof FormData?(e.contentType="multipart/form-data; charset=UTF-8",t=e.data):(e.contentType="application/json; charset=UTF-8",t=JSON.stringify(e.data));const o=document.querySelector('input[id="RequestVerificationToken"]');let a="";o&&(a=o.value);const s={RequestVerificationToken:a},r=Object.assign("GET"===e.method?{}:s,e.headers);if(e.contentType&&0!==e.contentType.indexOf("multipart/form-data")&&(r["Content-Type"]=e.contentType),e.responseType){const t={xml:"text/xml",html:"text/html",json:"application/json",text:"text/plain"};r.Accept=t[e.responseType]}const c=await fetch(e.url,{body:t,method:e.method,credentials:"same-origin",headers:r});if(!c.ok)throw c;return c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MFAComponent=void 0;const i=n(7),o=n(1),a=n(0);class s{constructor(e){var t;this._types=[],this._buttonSubmitHandler=e=>{this.selectedType&&(this.submitButtonElement.disabled=!0,this.selectedType.buttonSubmitHandler(e))},this._manualMfaOption=null,this.escalationKey=e.escalationKey||null,this.postVerificationAction=e.postVerificationAction||null,this.transactionId=e.transactionId||e.TransactionId,this.transactionType=e.TransactionType,this.updateSiteText(e.siteText),this.element=Alkami.Dom.parseHTML(r(this)),this.submitButtonElement=e.submitButtonElement,this.showBannerForError=e.showBannerForError,this.showBannerForValidationError=null===(t=e.showBannerForValidationError)||void 0===t||t,this.submitButtonElement.addEventListener("click",this._buttonSubmitHandler),this._defaultStepUpType=e.DefaultStepUpType,this.types=e.Types.map((e=>new i.MFATypeComponent(e,this))),this.selectedType=this.types[0],this.promise=new Promise(((e,t)=>{this.element.addEventListener("mfasuccess",(()=>{e(),this.destroy()})),this.element.addEventListener("mfacancel",(()=>{t(new Error("MFA was cancelled."))}))}))}static async init(e){var t,n;try{const i=null!==(n=null===(t=e.escalationKey)||void 0===t?void 0:t.split(".",2)[0])&&void 0!==n?n:"";await s.insertStyles();const r=await o.fetchMFAModel(i);if(!1===r.success)throw a.showResponseError(r),r;return new s(Object.assign({},r,e))}catch(e){throw e instanceof Response&&a.showResponseError(e),e}}static insertStyles(){let e=document.getElementById("mfa_styles");return e?Promise.resolve(e):new Promise(((t,n)=>{e=Alkami.Dom.parseHTML('<link id="mfa_styles" rel="stylesheet" type="text/css" href="/Modules/Alkami.Modules.RiskEvaluation/Styles/RiskEvaluation.min.css">'),e.addEventListener("load",(()=>{t(e)})),e.addEventListener("error",(e=>{n(e)})),document.head.appendChild(e)}))}get types(){return this._types}set types(e){var t;this._types=e.sort(((e,t)=>e.authenticationFactor===this._defaultStepUpType?-1:t.authenticationFactor===this._defaultStepUpType?1:0));for(let e=0;e<this._types.length;e++)if(5===this._types[e].transportMedium){this._types.push(this._types.splice(e,1)[0]);break}const n=this.element.querySelector(".mfa-tabs"),i=this.element.querySelector(".mfa-tab-panels"),o=this.element.querySelector(".mfa-tab-list");Alkami.Dom.removeChildNodes(o),Alkami.Dom.removeChildNodes(i),e.forEach((e=>{5!==e.transportMedium&&o.appendChild(e.tabElement),i.appendChild(e.element)})),n.style.display=e.length>1?"":"none",this.tabComponent=Alkami.Iris.TabListComponent.init(n)[0],this.tabComponent.activeTab=this.tabComponent.tabs[0],this.manualMfaOption=null!==(t=e.find((e=>5===e.transportMedium)))&&void 0!==t?t:null}set selectedType(e){if(e===this._manualMfaOption){this.toggleDisplay();try{this.types.forEach(((e,t)=>{e.tabElement.ariaSelected="false"}))}catch(e){}}this.types.forEach(((t,n)=>{if(t.selected=t===e,n>=this.tabComponent.tabs.length)return;const i=this.tabComponent.tabs[n];t.selected&&!i.active&&(this.tabComponent.activeTab=this.tabComponent.tabs[n])}))}get selectedType(){return this.types.find((e=>e.selected))||null}get manualMfaOption(){return this._manualMfaOption}set manualMfaOption(e){if(!e)return;e.canResendCode=!1,this._manualMfaOption=e;const t=this.element.querySelector("#type__sendtext");t.innerHTML+=c();t.querySelector(".verify-admin-code").addEventListener("click",(()=>{this.selectedType=this._manualMfaOption}))}setSubmitButtonText(e,t){this.submitButtonElement.innerHTML=`\n    ${t?'<span class="iris-loading" style="margin-left:10px; margin-right:10px; margin-top: 0px; margin-bottom: 0px;" data-size="small" role="progressbar" aria-valuemin="" aria-valuemax="" aria-valuetext="" aria-hidden="true">\n    <svg class="iris-loading-svg"  viewBox="25 25 50 50">\n        <circle class="iris-loading-path" cx="50" cy="50" r="20" />\n    </svg>\n</span>':""}\n    <span class="iris-button__text">${e}</span>`}cancel(){Alkami.Dom.dispatchEvent(this.element,"mfacancel",{component:this})}destroy(){this.element.remove(),this.submitButtonElement.removeEventListener("click",this._buttonSubmitHandler)}updateSiteText(e){for(const[t,n]of Object.entries(e))Alkami.Localization.SiteText.set(t,n)}toggleDisplay(){try{let e=document.getElementById("mfa_modal__button_2");if(e)e.style.display=""===e.style.display?"none":"";else{const t=document.getElementById("mfa_modal");if(!t)return;e=Alkami.Dom.parseHTML(l());t.querySelector(".iris-prompt__footer").prepend(e),e.addEventListener("click",(()=>{this.toggleDisplay(),this.selectedType=this.types[0]}))}}catch(e){return}const e=this.element.querySelector("#type__sendtext");e.style.display=""===e.style.display?"none":"";const t=document.getElementById("mfa_modal__button_0");t.style.display=""===t.style.display?"none":"";const n=this.element.querySelector("#mfa_tabs");n.style.display=""===n.style.display?"none":""}}t.MFAComponent=s;const r=e=>`<div class="mfa-component iris-content">\n            <p id="type__sendtext" class="mfa-sendtext-message">${Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyYourIdentity"]}</p>\n            <div id="mfa_tabs" class="mfa-tabs iris-tabs iris-tabs--sub mar-bottom--xl" aria-label="Authentication Methods" style="display:none">\n                <div class="iris-tabs__inner">\n                    <ul class="mfa-tab-list iris-tabs__list">\n                    </ul>\n                </div>\n            </div>\n            <div class="mfa-tab-panels"></div>\n        </div>`,c=()=>` ${Alkami.Localization.SiteText["AuthenticationType.AdminGeneratedMfa.IfNoAccess"]} <a class="verify-admin-code">${Alkami.Localization.SiteText["AuthenticationType.AdminGeneratedMfa.ClickHere"]}</a>`,l=()=>`\n    <button id="mfa_modal__button_2" class="iris-button iris-button--secondary" type="button">\n        <span class="iris-button__text">${Alkami.Localization.SiteText["AuthenticationType.AdminGeneratedMfa.Back"]}</span>\n    </button>`},function(e,t,n){e.exports=n(6)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),o=i.__importStar(n(0)),a=i.__importStar(n(9)),s=window.Alkami||{};s.Security=Object.assign({},s.Security,o);const r=window;r.Alkami=s,r.securePost=a.securePost,r.ajaxSecurePost=a.ajaxSecurePost,$((function(){a.initLegacyMFA()}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MFATypeComponent=void 0;const i=n(8),o=n(1),a=n(0);t.MFATypeComponent=class{constructor(e,t){this._canResendCode=!0,this._isCodeRequested=!1,this._selected=!1,this._isSubmitting=!1,this._isResending=!1,this._fontIconClassMap={email:"font-icon-email-alt",sms:"font-icon-mobile-sms",voice:"font-icon-receive-call",questions:"font-icon-question",token:"font-icon-lock-token",totp:"font-icon-phone2"},this.otpReceipt="",this.otpCodeMinuteToLive="",this._buttonLabels={challenge:Alkami.Localization.SiteText["SecondFactorAuthentication.Challenge.VerifyButtonText"],request_code:Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.SendCodeButtonText"],verify_code:Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.VerifyButtonText"]},this._buttonLoadingLabels={challenge:Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.VerifyButtonText.VerifyingState"],request_code:Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.SendCodeButtonText.SendingState"],verify_code:Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.VerifyButtonText.VerifyingState"]},this._activateHandler=()=>{this.parentComponent.selectedType=this},this.buttonSubmitHandler=async e=>{if(!1===this._isSubmitting){this._isSubmitting=!0,this.parentComponent.setSubmitButtonText(this._buttonLoadingLabels[this.screenName],!0);try{switch(this.screenName){case"challenge":case"verify_code":await this._verifyChallengeSubmitHandler();break;case"request_code":await this._requestCodeSubmitHandler()}}finally{this.refreshButtonLabel(),this._isSubmitting=!1}}},this.resendCodeSubmitHandler=async()=>{if(!1===this._isResending){this._isResending=!0;try{this.parentComponent.submitButtonElement.disabled=!0,await this.requestCode(),this.isCodeRequested=!0,this.parentComponent.submitButtonElement.disabled=!1,this.canResendCode=!1,setTimeout((()=>this.canResendCode=!0),6e4)}catch(e){this._displayError(e)}finally{this._isResending=!1}}},this.resetSubmitHandler=()=>{this.choiceInputs.forEach((e=>e.checked=!1)),this.answerInputs.forEach((e=>e.value="")),this.isCodeRequested=!1},this._requestCodeSubmitHandler=async()=>{try{await this.requestCode(),this.isCodeRequested=!0,this.canResendCode=!0}catch(e){this._displayError(e)}},this._verifyChallengeSubmitHandler=async()=>{const e=this.choiceInputs,t=1===e.length?e[0]:e.find((e=>e.checked)),n=t?t.value:"";try{if(await this.verifyCode(),this.parentComponent.postVerificationAction){const e={success:!0,mfaType:this.name,isLocked:!1,mfaContact:n};await this.parentComponent.postVerificationAction(e)}Alkami.Dom.dispatchEvent(this.parentComponent.element,"mfasuccess",this.parentComponent)}catch(e){if(this.parentComponent.postVerificationAction){const t={success:!1,mfaType:this.name,isLocked:!!e.lockedOutUrl,mfaContact:n};await this.parentComponent.postVerificationAction(t)}e.lockedOutUrl?window.location.href=e.lockedOutUrl:(this._displayError(e,e.errorMessage),this.answerInputs.forEach((e=>{e.value=""})),e.choices&&e.choices.length>0&&(this.choices=e.choices))}},this.returnKeyPress=async e=>{if(13!==e.keyCode)return!0;this.buttonSubmitHandler(e)},this._choiceChangeHandler=e=>{this.parentComponent.submitButtonElement.disabled=!this.validateRequestCodeScreen()},this._challengeChangeHandler=e=>{const t=e.currentTarget,n=this.parentComponent.submitButtonElement,i=this.validateChallengeScreen();n.disabled=!i,this.answerInputs&&this.answerInputs.length>1&&(!0===i?t.addEventListener("keypress",this.returnKeyPress):t.removeEventListener("keypress",this.returnKeyPress))},this.name=e.Name,this._choices=e.Choices,this.authenticationFactor=e.AuthenticationFactor,this.transportMedium=e.TransportMedium,this.requiresChoice=e.RequiresChoice,this.authenticatorProviderId=e.AuthenticatorProviderId,this.parentComponent=t,this.element=Alkami.Dom.parseHTML(i.template(this)),this.tabElement=Alkami.Dom.parseHTML(i.tabTemplate(this)),this.wireEventListeners(),this.selected=!1,this.canResendCode=!0}get choices(){return this._choices}set choices(e){this._choices=e,this.element.innerHTML=this.requiresChoice?i.choicesTemplate(this):i.challengeTemplate(this),this.wireEventListeners(),this.refreshUI()}get sendText(){return"sms"===this.name&&1===this.choices.length?Alkami.Localization.SiteText.get("RiskEvaluation.SendText.MultipleSMSNumbers",this.choices[0]):"email"===this.name&&1===this.choices.length?Alkami.Localization.SiteText.get("RiskEvaluation.SendText.OneEmail",this.choices[0]):"voice"===this.name&&1===this.choices.length?Alkami.Localization.SiteText.get("RiskEvaluation.SendText.OnePhoneNumber",this.choices[0]):"questions"===this.name&&1===this.choices.length?Alkami.Localization.SiteText.get("RiskEvaluation.Description.OneQuestion",this.choices[0]):"manual"===this.name&&1===this.choices.length?Alkami.Localization.SiteText.get("AuthenticationType.AdminGeneratedMfa.Verify",this.choices[0]):"sms"===this.name?Alkami.Localization.SiteText["RiskEvaluation.SendText.MultipleSMSNumbers"]:"email"===this.name?Alkami.Localization.SiteText["RiskEvaluation.SendText.MultipleEmails"]:"voice"===this.name?Alkami.Localization.SiteText["RiskEvaluation.SendText.MultiplePhoneNumbers"]:"questions"===this.name?Alkami.Localization.SiteText["RiskEvaluation.Descritpion.MultipleQuestions"]:""}get label(){switch(this.name){case"email":return Alkami.Localization.SiteText["SecondFactorAuthentication.AuthenticationType.Email"];case"sms":return Alkami.Localization.SiteText["SecondFactorAuthentication.AuthenticationType.SMS"];case"voice":return Alkami.Localization.SiteText["SecondFactorAuthentication.AuthenticationType.Voice"];case"questions":return Alkami.Localization.SiteText["SecondFactorAuthentication.AuthenticationType.Questions"];case"token":return Alkami.Localization.SiteText["SecondFactorAuthentication.AuthenticationType.Token"];case"totp":return Alkami.Localization.SiteText["SecondFactorAuthentication.AuthenticationType.TOTP"];default:return Alkami.Utils.StringHelper.capitalize(this.name)}}get selected(){return this._selected}set selected(e){this._selected=e,e&&this.refreshUI(),this.element.style.display=e?"":"none"}get fontIconClass(){const e=this._fontIconClassMap[this.name]||"";return e}get challengePlaceholder(){return"questions"===this.name?Alkami.Localization.SiteText["SecondFactorAuthentication.Challenge.AnswerPlaceholder"]:Alkami.Localization.SiteText["SecondFactorAuthentication.Challenge.EnterCodePlaceholder"]}get codeExpiryMessage(){return Alkami.Localization.SiteText.get("SecondFactorAuthentication.VerifyCode.CodeExpiryMessage",this.otpCodeMinuteToLive)}get resetText(){return"email"===this.name?Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.TryAnotherEmail"]:Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.TryAnotherNumber"]}set isCodeRequested(e){this._isCodeRequested=e,this.refreshUI()}get isCodeRequested(){return this._isCodeRequested}get screenName(){return this.requiresChoice?this.isCodeRequested?"verify_code":"request_code":"challenge"}set canResendCode(e){this._canResendCode=e;const t=this.element.querySelector(`#${this.name}_resend_code`);t&&(t.disabled=!e,t.innerHTML=`<span class="iris-button__text">${this._canResendCode?"Resend Code":"Code Sent"}</span>`)}get canResendCode(){return this._canResendCode}get answerInputs(){return Array.from(this.element.querySelectorAll("[name=Answers]"))}get choiceInputs(){return Array.from(this.element.querySelectorAll("[name=Choice]"))}refreshUI(){const e=Array.from(this.element.querySelectorAll(".mfa-screen")),t=this.element.querySelector(`#type_${this.name}_${this.screenName}`),n=this.parentComponent.element.querySelector("#type__sendtext"),i=this.parentComponent.element.querySelector(".iris-tabs__list");i&&1===i.childElementCount&&(n.style.display="none"),e.forEach((e=>{e.style.display="none"})),t.style.display="",this.refreshButtonLabel();const o=this.parentComponent.submitButtonElement;"request_code"===this.screenName?o.disabled=!this.validateRequestCodeScreen():"challenge"===this.screenName?o.disabled=!this.validateChallengeScreen():o.disabled=!1,this._hideErrorElement()}updateExpirationTime(){const e=document.querySelector(`.mfa-code-expiry-message[data-mfatype="${this.name}"]`);null!=e&&(e.innerHTML=this.codeExpiryMessage)}async requestCode(){const e=this.choiceInputs,t=1===e.length?e[0]:e.find((e=>e.checked)),n=t?t.value:"",i=await o.requestVerficationCode({Answers:[],Choices:this.choices,AuthenticationFactor:this.authenticationFactor,Choice:n,RequiresChoice:this.requiresChoice,AuthenticatorProviderId:this.authenticatorProviderId}),a=await i.json();if(!a.success)throw a;return this.otpReceipt=a.otpReceipt,this.otpCodeMinuteToLive=a.otpCodeMinuteToLive,this.updateExpirationTime(),a}async verifyCode(){const e=this.choiceInputs,t=1===e.length?e[0]:e.find((e=>e.checked)),n=t?t.value:"",i=this.answerInputs.map((e=>e.value)),a=await o.validateAnswers({Answers:i,Choices:this.choices,AuthenticationFactor:this.authenticationFactor,Choice:n,TransactionType:this.parentComponent.transactionType,TransactionId:this.parentComponent.transactionId,EscalationKey:this.parentComponent.escalationKey,AuthenticatorProviderId:this.authenticatorProviderId,OTPReceipt:this.otpReceipt,TransportMedium:this.transportMedium}),s=await a.json();if(!s.success)throw s;return s}validateRequestCodeScreen(){const e=this.choiceInputs.find((e=>e.checked));return this.choices.length<=1||!!e}validateChallengeScreen(){return 0===this.answerInputs.filter((e=>!e.value)).length}wireEventListeners(){this.tabElement.addEventListener("activate",this._activateHandler);const e=this.element.querySelector(`#${this.name}_reset`);e&&e.addEventListener("click",this.resetSubmitHandler);const t=this.element.querySelector(`#${this.name}_resend_code`);t&&t.addEventListener("click",this.resendCodeSubmitHandler),this.choiceInputs.forEach((e=>{e.addEventListener("change",this._choiceChangeHandler)})),this.answerInputs.forEach((e=>{e.addEventListener("input",this._challengeChangeHandler),e.addEventListener("focus",this._hideErrorElement)}));Array.from(this.element.querySelectorAll(`#type_${this.name}_challenge_form, #type_${this.name}_verify_code_form`)).forEach((e=>{e.addEventListener("submit",(e=>{e.preventDefault(),this.buttonSubmitHandler(e)}))}));const n=this.tabElement.querySelector(".iris-tabs__link");n&&n.addEventListener("click",(e=>{e.preventDefault()}))}refreshButtonLabel(){this.parentComponent.setSubmitButtonText(this._buttonLabels[this.screenName],!1)}_displayError(e,t){if(this.parentComponent.showBannerForValidationError)a.showResponseError(e);else if(t)this._showErrorElement(t);else{const t=e instanceof Response?e.json():e,n=Alkami.Localization.SiteText[t.errorSiteTextKey]||t.errorMessage||Alkami.Localization.SiteText.get("ShortGeneralErrorMessage");this._showErrorElement(n)}}_hideErrorElement(){Array.from(document.querySelectorAll('[id$="_error_message_div"]')).forEach((e=>{e.style.display="none"}))}_showErrorElement(e){const t=this.element.querySelector(`#${this.name}_error_message_div`),n=this.element.querySelector(`#${this.name}_error_message_text`);e&&""!==e&&(t&&(t.style.display=""),n&&(n.innerHTML=e))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.challengeInputTemplate=t.choiceInputTemplate=t.verifyCodeTemplate=t.requestCodeTemplate=t.choicesTemplate=t.challengeTemplate=t.template=t.tabTemplate=void 0,t.tabTemplate=e=>`<li id="type_${e.name}_tab" class="iris-tabs__list-item" aria-controls="type_${e.name}_tab_panel">\n            <p class="iris-tabs__link">\n                <span class="iris-tabs__link-icon ${e.fontIconClass}"></span>\n                <span class="iris-tabs__link-text">${e.label}</span>\n            </p>\n         </li>`,t.template=e=>`<div id="type_${e.name}_tab_panel" class="tab_panel" aria-labelledby="type_${e.name}_tab">\n\t        ${e.requiresChoice?t.choicesTemplate(e):t.challengeTemplate(e)}\n         </div>`,t.challengeTemplate=e=>{if(e.sendText)return`<div id="type_${e.name}_challenge" class="mfa-screen">\n        <p id="type_${e.name}_sendtext_challenge" class="mfa-sendtext-message">${e.sendText}</p>\n        <form id="type_${e.name}_challenge_form">\n            <div id="type_${e.name}_challenges">\n                ${e.choices.map(((n,i)=>t.challengeInputTemplate(n,i,e))).join("")}\n            </div>\n        </form>\n    </div>`;return`<div id="type_${e.name}_challenge" class="mfa-screen">\n    <form id="type_${e.name}_challenge_form">\n        <div id="type_${e.name}_challenges">\n            ${e.choices.map(((n,i)=>t.challengeInputTemplate(n,i,e))).join("")}\n        </div>\n    </form>\n</div>`},t.choicesTemplate=e=>t.requestCodeTemplate(e)+t.verifyCodeTemplate(e),t.requestCodeTemplate=e=>{let n=`<div id="type_${e.name}_request_code" class="mfa-screen">\n    <p id="type_${e.name}_sendtext_requestcode" class="mfa-sendtext-message">${e.sendText}</p>\n    <form id="type_${e.name}_request_code_form">`;return e.choices.length>1?n+=`<div id="type_${e.name}_choices">\n    <fieldset class="iris-form-groupset iris-form-groupset--stacked pad-bottom--lg" aria-labelledby="type_${e.name}_sendtext_requestcode">\n        <div class="iris-form-groupset__container">\n            <div class="iris-form-groupset__groups">\n                ${e.choices.map(((n,i)=>t.choiceInputTemplate(n,i,e))).join("")}\n            </div>\n        </div>        \n    </fieldset>\n</div>`:n+=`<input type="hidden" name="Choice" value="${e.choices[0]}" />`,n+="</form></div>",n},t.verifyCodeTemplate=e=>`<div id="type_${e.name}_verify_code" class="mfa-screen">\n    <p id="type_${e.name}_sendtext_verifycode" class="mfa-sendtext-message">\n        <span id="type_${e.name}_choice_message"></span>\n        <span class="mfa-code-expiry-message" data-mfatype="${e.name}" style='font-size:smaller'>${e.codeExpiryMessage}</span>\n    </p>\n    <form id="type_${e.name}_verify_code_form">\n        <div class="iris-form-group iris-form-group--stacked">\n            <label class="iris-form-group__label" for="${e.name}_verify_code_input">${Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.EnterCodePlaceholder"]}</label>\n            <div class="iris-form-group__field">\n                <div class="iris-textfield">\n                    <input id="${e.name}_verify_code_input" name="Answers" type="text" class="iris-textfield__input" autocomplete="off" aria-required="true" required aria-describedby="type_${e.name}_sendtext_verifycode"/>\n                </div>\n            </div>\n            <div id="${e.name}_error_message_div" class="iris-notification iris-notification--breadbox iris-notification--negative" style="margin-bottom:16px" role="alert">\n                <div class="iris-notification__context">\n                    <span class="font-icon-error" role="img" aria-label="Error!"></span>\n                </div>\n                <div id="${e.name}_error_message_text" class="iris-notification__message"></div>\n            </div>\n        </div>\n        <div class="button-group">\n            <button id="${e.name}_resend_code" class="iris-button iris-button--ghost pad--0" type="button"></button>\n        ${e.choices.length<=1?"":`<span class="font-size--xs"> ${Alkami.Localization.SiteText["SecondFactorAuthentication.VerifyCode.ResendCode.Or"]} </span>\n        <button id="${e.name}_reset" class="iris-button iris-button--ghost pad--0" type="button">\n            <span class="iris-button__text">${e.resetText}</span>\n        </button>`}\n        </div>\n    </form>\n</div>`,t.choiceInputTemplate=(e,t,n)=>`<div class="iris-radio">\n    <input class="iris-radio__input" type="radio" id="${n.name}_option_${t}" name="Choice" value="${e}" />\n    <label class="iris-radio__label" for="${n.name}_option_${t}">\n        <span class="iris-radio__content">${e}</span>\n    </label>\n</div>`,t.challengeInputTemplate=(e,t,n)=>`<div class="iris-form-group iris-form-group--stacked">\n    <label class="iris-form-group__label" for="challenge_${n.name}_${t}">${e}</label>\n    <div class="iris-form-group__field">\n        <div class="iris-textfield">\n            <input id="challenge_${n.name}_${t}" name="Answers" type="text" class="iris-textfield__input" aria-required="true" required />\n        </div>\n    </div>\n</div>`},function(e,t,n){"use strict";function i(){-1!==document.URL.toLowerCase().indexOf("mobile")?0==$("#second_factor_container").length&&$("body").append("<div id='second_factor_container' class='card-container card-container-modal' style='display: none;'></div>"):0==$("#second_factor").length&&$("body").append("<div id='second_factor' class='modal fade' role='dialog' style='display: none;'></div>")}function o(e,t,n){var i=$.Event("show.bs.modal",{relatedTarget:$("#second_factor_container, #second_factor")[0]});return $("#second_factor_container, #second_factor").trigger(i),function(){var e=document.querySelector(".modal-backdrop"),t=document.querySelector(".modal.fade.in");null!==e&&(e.setAttribute("old-display-value",window.getComputedStyle(e).display||""),e.style.display="none");null!==t&&(t.setAttribute,t.setAttribute("old-display-value",window.getComputedStyle(t).display||""),t.style.display="none")}(),Alkami.Security.initMFAModal({escalationKey:e.verificationToken,transactionId:e.transactionId}).then((function(e){r();var n=$.Event("hide.bs.modal");$("#second_factor_container, #second_factor").trigger(n),t&&t()})).catch((function(e){if(e.instanceof!==Response)return r(),Promise.reject(e);var t=e.statusText,i=e.clone();e.json().then((function(e){n(e,t,i)}))}))}function a(e,t,n,i,a){Alkami.Security.createCMICookie(),$.ajax({method:"POST",url:t[0].action,data:t.serialize(),cache:!1,success:function(n,i,s){if(n.Location)window.location.href=n.Location;else if(!0===n.success&&!1===n.skip){o(n,(function(){e(t)}),a).catch((function(){a()}))}else if(!1!==n.success||void 0===n.errorMessage&&void 0===n.errorSiteTextKey)e&&e(n,i,s);else{var r=void 0!==n.errorSiteTextKey?Alkami.Localization.SiteText[n.errorSiteTextKey]:n.errorMessage;Alkami.Security.showErrorMessage(r),a&&a(n,i,s)}}})}function s(e,t,n,a,r,c,l,d,u,h){$('input[name="__RequestVerificationToken"]')&&"object"==typeof t&&(t.__RequestVerificationToken=$('input[name="__RequestVerificationToken"]').val()),null==h&&(h=!0),i(),$.ajax({method:"POST",url:e,data:t,cache:!1,contentType:u,processData:h,success:function(i,p,m){if("string"==typeof i&&(i=JSON.parse(i||"{}")),i.Location)window.location.href=i.Location;else if(i.success&&!1===i.skip)o(i,(function(){s(e,t,n,a,r,c,l,d,u,h)}),a).catch((function(){r()}));else if(!1!==i.success||void 0===i.errorMessage&&void 0===i.errorSiteTextKey)n(i,p,m);else if(a)a(i,p,m);else{var f=void 0!==i.errorSiteTextKey?Alkami.Localization.SiteText[i.errorSiteTextKey]:i.errorMessage;Alkami.Security.showErrorMessage(f)}},error:a})}function r(){var e=document.querySelector(".modal-backdrop"),t=document.querySelector(".modal.fade.in");null!==e&&"none"===e.style.display&&(e.style.display=e.getAttribute("old-display-value"),e.removeAttribute("old-display-value")),null!==t&&"none"===t.style.display&&(t.style.display=t.getAttribute("old-display-value"),t.removeAttribute("old-display-value"))}n.r(t),n.d(t,"initLegacyMFA",(function(){return i})),n.d(t,"securePost",(function(){return a})),n.d(t,"ajaxSecurePost",(function(){return s}))}]);
//# sourceMappingURL=RiskEvaluation.2.28.0.min.js.map