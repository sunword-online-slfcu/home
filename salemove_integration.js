!function(){function t(t,e,n){sm.getApi({version:"v1"}).then(function(){sm.logger[t](e,n)})}function e(){return sm._sessionContext&&sm._sessionContext.access_token}function n(){var e=O.match(/__sm[\._]accessToken=([^&#]+)/);if(e)return t("info","Found access token in the page query string"),e[1]}function o(){var e=localStorage.getItem("sm.access_token");if(e)return t("info","Found access token from the local storage"),e}function r(){var t=e()||n()||o();return t?"access_token="+t:""}function i(){var e=O.match(/__sm[\._]consolidation=([^&#]+)/);if(e)return t("info","Found consolidation token in the page query string"),e[1]}function s(){var t=i();return t?"consolidation_token="+t:""}function a(t){return t&&"string"==typeof t}function c(t){return"external_session_id="+t}function u(t){return"id_token="+t}function f(t){return"external_access_token="+t}function d(t){var e=a(t.sessionId)?c(t.sessionId):"",n=a(t.idToken)?u(t.idToken):"",o=a(t.accessToken)?f(t.accessToken):"";return[e,n,o]}function l(e){return new Promise(function(n){e.then(function(t){n(d(t))})["catch"](function(e){t("warn","Failed to resolve getGliaContext promise",{error:e}),n([])})})}function m(t){var e="function"==typeof t.then;return e?l(t):d(t)}function p(){try{return window.getGliaContext||window.top.getGliaContext}catch(t){return window.getGliaContext}}function g(){var e=p();if(e&&"function"==typeof e)try{var n=e();if(n)return m(n)}catch(e){t("warn","Unexpected error in getGliaContext()",{error:e})}return[]}function _(){return sm._sessionContext&&sm._sessionContext.visitor_priority}function v(){var t=O.match(/__sm[\._]visitor_priority=(low|high)/i);if(t)return t[1]}function h(){return localStorage.getItem("sm.visitor_priority")}function w(){var t=_()||v()||h();return t&&"low"!==t?"priority="+encodeURIComponent(t):""}function y(){var t=H.site_id;return t?"site_id="+t:""}function b(){var e=O.match(/__sm[\._]tabId=([^&#]+)/);if(e){t("info","Found tab ID from the page query string");var n=e[1];return sm.tabId=n,"tab_id="+n}}function x(t){for(var e in t)if("unloaded"===t[e])return e}function k(){var t=JSON.parse(sessionStorage.getItem("sm.tab_ids"))||{},e=Object.keys(t),n=e.map(function(t){return"session_tab_ids[]="+t}).join("&"),o=x(t);return o&&!sm.tabId&&(n+="&tab_id="+o),n}function C(t){if(delete window.sm.loadDynamic,t.visitor_configuration){sm.conf=t.visitor_configuration,sm.conf.customCodeFile=t.custom_code_file,sm.visitorId=t.visitor_id,sm.accessToken=t.access_token,sm.authenticatedExternally=t.authenticated_externally,sm.visitorConfigUrl=U;var e=function(t){var e=sm.conf.assets.s3_prefix;return sm.conf.assets.server.indexOf("libs.")!==-1&&(e="/"),(e||"/")+(sm.conf.assets.hashes&&sm.conf.assets.hashes[t]||t)},n=document.createElement("script");if(n.setAttribute("src",sm.conf.assets.server+e("visitor/bootstrapper.js")),n.setAttribute("type","text/javascript"),sm.conf.integrities_enabled){var o=function(){for(var t=0;t<sm.conf.integrities.length;t++)if("bootstrapper"===sm.conf.integrities[t].name)return sm.conf.integrities[t].integrity};n.setAttribute("integrity",o()),n.setAttribute("crossorigin","*")}var r=!1,i=function(){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r=!0,sm.Bootstrapper.boot(),n.onload=n.onreadystatechange=null)};n.onload=n.onreadystatechange=i,n.onerror=function(){for(var t=0;t<sm._apiHandlers.length;t++)sm._apiHandlers[t].reject({cause:"network timeout",message:"Failed to load Glia JS API"});n.onerror=null},t.boot_delay_ms>0?setTimeout(function(){document.head.appendChild(n)},t.boot_delay_ms):document.head.appendChild(n)}}if(!window.sm){var I=document.currentScript||document.querySelector('script[src*="salemove_integration.js"]');if(!I)return void console.error("Unable to find the salemove_integration.js script on the page.");window.sm={loadDynamic:!0},sm._apiHandlers=[],sm.getApi=function(t){return"function"==typeof sm._getApi?sm._getApi(t):new Promise(function(e,n){sm._apiHandlers.push({options:t,resolve:e,reject:n})})};var S=function(t){if(!t)return!1;var e="sm.test";try{return t.setItem(e,"1"),t.removeItem(e),!0}catch(t){return!1}},j=function(){return null!=window.location},A=S(window.localStorage)&&S(window.sessionStorage)&&j()&&window.MutationObserver;if(!A)return;var T=function(){var t=navigator.userAgent;return!t||/(.*https?:\/\/|bot|googlebot|crawler|spider|robot|crawling|dejaclick)/i.test(t)};if(T())return;var F=function(t){var e=t.indexOf("?");return e!==-1?t.substring(e+1):""},O=F(window.location.href),H=function(){var t=F(I.src);return""===t?{}:t.split("&").reduce(function(t,e){var n=e.split("=");return t[n[0]]=n[1],t},{})}();if(H.session_context){t("info","Found session context in integration script query string");var q=H.session_context;try{var G=atob(decodeURIComponent(q));sm._sessionContext=JSON.parse(G)}catch(e){t("warn","Could not parse session context")}}var R=["referrer="+encodeURIComponent("null"===location.origin&&"srcdoc"===location.pathname?location.ancestorOrigins[0]:location.origin+location.pathname),w(),y(),b()].filter(function(t){return""!==t}).join("&"),U=I.src.replace(new RegExp("//(assets|cdn|app)\\.([^/]+)/assets/salemove_integration\\.js"),"//api.$2/salemove_integration.js").replace(/salemove_integration\.js.*/,"visitor_config?"+R);Promise.all([r(),s(),g(),k()]).then(function(t){var e=t.reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return""!==t}).join("&"),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){var t=JSON.parse(n.responseText);C(t)}else for(var e=0;e<sm._apiHandlers.length;e++)sm._apiHandlers[e].reject({cause:"network timeout",message:"Failed to fetch site and visitor configuration",response_code:this.status})},n.open("POST",U,!0),n.withCredentials=!0,n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(e)})}}();